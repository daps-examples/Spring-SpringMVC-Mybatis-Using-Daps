{
  "dbPolicyInfo": {
    "rdsPolicyList": [
      {
        "type": "oracle",
        "user": "system",
        "host": [
          "192.168.126.245:3306"
        ],
        "rules": [
          {
            "dbName": [
              "ssm"
            ],
            "schemaNames": [
              "system",
              "ssm",
              "public",
              "dbo",
              "test"
            ],
            "tableName": [
              "users"
            ],
            "algorithm": {
              "cryptor": {
              },
              "readHandler": [
                "mask"
              ],
              "writeHandler": [
              ],
              "mask": {
                "name": "保留前n后m",
                "parameters": "{\"algorithm\":\"keepFrontBack\",\"n\":\"2\",\"m\":\"4\",\"method\":\"#\"}",
                "type": "MASK",
                "action": "keepFrontBack,2,4,#"
              }
            },
            "fieldList": [
              {
                "fieldId": "317661475238651918",
                "name": "user_phone",
                "namePlain": "user_phone",
                "type": "varchar",
                "length": 256
              }
            ]
          }
        ]
      }
    ]
  },
  "scripts": "function keepFrontBack(srcStr,n,m,maskChar){n=Math.max(n,0);m=Math.max(m,0);m=Math.min(m,len(srcStr));return len(srcStr)>m+n?safe(srcStr,n,m,-1,maskChar):srcStr}function safe(srcStr,n,m,mask,maskChar){mask=-1;if(isBlank(srcStr)){return stars(mask,len(srcStr))}else{var srcLen=srcStr.length;if(srcLen<=1){return stars(mask,srcLen,maskChar)}else if(srcLen<=2){return stars(mask,srcLen-1,maskChar)+srcStr.substring(srcLen-1)}else{var maskLen=-1;if(maskLen<0){maskLen=srcLen-n-m}return maskLen<=0?stars(maskLen,srcLen,maskChar):srcStr.substring(0,n)+stars(maskLen,srcLen,maskChar)+srcStr.substring(srcLen-m)}}}function isBlank(value){return value==null||\"\"==value.trim()}function len(value){return value==null?0:value.length}function stars(maskLen,srcLen,maskChar){if(maskLen==-1){maskLen=srcLen}if(maskLen<=0){return\"\"}else{var mask=\"\";for(var i=0;i<maskLen;++i){mask+=maskChar}return mask.toString()}}"
}